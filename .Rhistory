setwd("~/Documents/USIPC/r/summer20")
# =========
# SET UP
# =========
rm(list = ls())
library(gmodels)
d <- read.csv("practice-082520.csv")
setwd("~/Documents/USIPC/r/summer20/csv")
d <- read.csv("practice-082520.csv")
d$sikh <- NA
d$sikh[d$var1 == "No"] <- 0
d$sikh[d$var1 == "Yes"] <- 1
CrossTable(d$sikh) # The odds that the voter is Sikh is 106/26 or 4.0769
library(gmodels)
library(gmodels)
CrossTable(d$var1)
d$sikh <- NA
d$sikh[d$var1 == "No"] <- 0
d$sikh[d$var1 == "Yes"] <- 1
CrossTable(d$sikh) # The odds that the voter is Sikh is 106/26 or 4.0769
# Predictor is if individual is a participant of the survey, outcome is if they are Sikh
d$participant <- 1
logodds <- glm(formula = sikh ~ participant,family = binomial(link = "logit"), data = d)
summary(logodds) # the log odds are 1.4053.
odds_ratio <- exp(1.4053) #The odds ratio with e^1.4053 = 4.0769
skewness(smokers_bwt)
kurtosis(smokers_bwt)
# ======
# SETUP
# ======
df = read.delim("babies.txt", sep = "")
setwd("~/Documents/MATH 189/MATH-189-PROJECTS")
# ======
# SETUP
# ======
df = read.delim("babies.txt", sep = "")
# check dataset, clean up mistakes
table(df$smoke)
df$smoke[df$smoke == 9] <- 0 #recode random 9 to 0
smokers = df[df$smoke == 1,]
nonsmokers = df[df$smoke == 0,]
# create skewness and kurtosis functions
skewness <- function(X) {
Xbar = mean(X)
Z <- (X - Xbar) / sd(X)
return(Z^3)
}
kurtosis <- function(X) {
Xbar = mean(X)
Z <- (X - Xbar) / sd(X)
return(Z^4)
}
skewness(smokers_bwt)
smokers_bwt = smokers$bwt
nonsmokers_bwt = nonsmokers$bwt
# birthweight - smokers
smokers_bwt = smokers$bwt
skewness(smokers_bwt)
kurtosis(smokers_bwt)
smokers_skew = skewness(smokers_bwt)
smokers_kurtosis = kurtosis(smokers_bwt)
# create skewness and kurtosis functions
skewness <- function(X) {
Xbar = mean(X)
Z <- (X - Xbar) / sd(X)
return(mean(Z^3))
}
kurtosis <- function(X) {
Xbar = mean(X)
Z <- (X - Xbar) / sd(X)
return(mean(Z^4))
}
smokers_skew = skewness(smokers_bwt)
smokers_kurtosis = kurtosis(smokers_bwt)
skewness(nonsmokers_bwt)
kurtosis(nonsmokers_bwt)
# birthweight - nonsmokers
nonsmokers_bwt = nonsmokers$bwt
skewness(nonsmokers_bwt)
kurtosis(nonsmokers_bwt)
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt, nonsmokers_bwt)
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt)
?qqnorm
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt, nonsmokers_bwt)
?qqnorm
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt)
## qqnorm - check if is a normal distribution
qqnorm(x= smokers_bwt, y = nonsmokers_bwt)
?qqnorm
## qqnorm - check if is a normal distribution
qqnorm(x= smokers_bwt)
## qqnorm - check if is a normal distribution
qqnorm(x= smokers_bwt)
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt)
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt,
main = "Infant Birth Weights (Smokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Smokers")
qqnorm(nonsmokers_bwt,
main = "Infant Birth Weights (Nonsmokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Nonsmokers")
par(1, 3)
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt,
main = "Infant Birth Weights (Smokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Smokers")
qqnorm(nonsmokers_bwt,
main = "Infant Birth Weights (Nonsmokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Nonsmokers")
?par
par(mfrow = c(1, 3))
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt,
main = "Infant Birth Weights (Smokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Smokers")
qqnorm(nonsmokers_bwt,
main = "Infant Birth Weights (Nonsmokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Nonsmokers")
# qqplot
qqplot(x= smokers_bwt, y = nonsmokers_bwt,
pch = 1, cex = 0.75,
xlab = "birthweight (smokers)",
ylab = "birthweight (nonsmokers)",
main = "Infant Birthweight (oz): Smokers vs Nonsmokers",
xlim= c(50, 180), ylim = c(50, 180))
# qqplot
qqplot(x= smokers_bwt, y = nonsmokers_bwt,
pch = 1, cex = 0.75,
xlab = "birthweight (smokers)",
ylab = "birthweight (nonsmokers)",
main = "Infant Birthweight (oz): Smokers vs Nonsmokers",
xlim= c(50, 180), ylim = c(50, 180))
abline(0, 1, lty = "dashed", col = "gray")
## qqnorm - check if is a normal distribution
qqnorm(smokers_bwt,
main = "Infant Birth Weights (Smokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Smokers")
abline(0, 1, lty = "dashed", col = "gray")
qqnorm(nonsmokers_bwt,
main = "Infant Birth Weights (Nonsmokers) vs Normal Distribution",
xlab = "Normal Distribution",
ylab = "Nonsmokers")
abline(0, 1, lty = "dashed", col = "gray")
#simulation
X = rnorm(0, 1)
#simulation
X = rnorm(1000)
obs = phat_s - phat_n
# ---------------------------------------------------------------------------
# 2.3
# ---------------------------------------------------------------------------
# number of low birth weights and size of each sample
lbwt_smokers = length(smokers_bwt[smokers_bwt <= 88])
lbwt_nonsmokers = length(nonsmokers_bwt[nonsmokers_bwt <= 88])
n_smokers = nrow(smokers)
n_nonsmokers = nrow(nonsmokers)
# proportion of low birth rates in two groups
phat_s = lbwt_smokers/n_smokers
phat_n = lbwt_nonsmokers/n_nonsmokers
obs = phat_s - phat_n
pnorm(obs, lower.tail = False)
pnorm(obs, lower.tail = F)
?prop.test
prop.test(c(phat_s, phat_n), c(n_smokers, n_nonsmokers), alternative = greater)
prop.test(c(phat_s, phat_n), c(n_smokers, n_nonsmokers), alternative = "greater")
prop.test(c(lbwt_smokers, lbwt_nonsmokers), c(n_smokers, n_nonsmokers), alternative = "greater")
# calculate z score to evaluate reliability
pstar = (lbwt_smokers + lbwt_nonsmokers)/ nrow(df)
qstar = (length(smokers_bwt[smokers_bwt > 88]) +
length(nonsmokers_bwt[nonsmokers_bwt > 88]))/ nrow(df)
z = (phat_s - phat_n) / sqrt((pstar*qstar)/n_smokers +
(pstar*qstar)/n_nonsmokers )
# calculate pvalue
pvalue =  pnorm(x, lower = F) * 2
# calculate pvalue
pvalue =  pnorm(z, lower = F) * 2
length(smokers_bwt[smokers_bwt > 88]) +
length(nonsmokers_bwt[nonsmokers_bwt > 88])
lbwt_smokers + lbwt_nonsmokers
nrow(df)
1173 + 63
glm(smoke ~ bwt, family = "binomial", data = smokers)
View(smokers)
glm(smoke ~ bwt + , family = "binomial", data = df)
glm(smoke ~ bwt  family = "binomial", data = df)
glm(smoke ~ bwt,  family = "binomial", data = df)
exp(-0.02874)
glm(smoke ~ bwt + gestation + parity + age + height + weight,  family = "binomial", data = df)
exp(-3.031e-02)
mod <- glm(smoke ~ bwt + gestation + parity + age + height + weight,  family = "binomial", data = df)
mod$coefficients
mod$coefficients["bwt"]
bwt.coef <- mod$coefficients["bwt"]
log.odds <- exp(bwt.coef) # 0.9701447 (i.e. )
summary(mod)
t.test(smokers$bwt, nonsmokers$bwt)
# -------
# 3.2
# -------
t.test(smokers$bwt, nonsmokers$bwt, alternative = "greater")
# -------
# 3.2
# -------
t.test(smokers$bwt, nonsmokers$bwt, alternative = "less")
# -------
# 3.2
# -------
t.test(nonsmokers$bwt, smokers$bwt, alternative = "greater")
mean(nonsmokers_bwt) - mean(smokers$bwt)
